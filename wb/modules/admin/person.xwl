{"hidden":false,"children":[{"configs":{"itemId":"module","description":"点击图片直接打开文件和预览的功能支持Chrome,FF, IE10+和其他现代浏览器\nIE9-版本不支持该功能"},"expanded":true,"children":[{"configs":{"layout":"fit","itemId":"editWin","focusControl":"PERSON_CODE","editWin":"true","width":"620","iconCls":"user_icon","title":"人员"},"expanded":true,"children":[{"configs":{"itemId":"form","defaults":"{\n  margin: '10'\n}"},"expanded":true,"children":[{"configs":{"layout":"fit","itemId":"loginInfo","title":"登录帐户","collapsible":"true"},"expanded":true,"children":[{"configs":{"border":"false","itemId":"panel1","autoStyle":"true"},"expanded":true,"children":[{"configs":{"itemId":"USER_NAME","allowBlank":"false","bindField":"USER_ID","fieldLabel":"用户名称","displayField":"USER_NAME"},"expanded":true,"children":[{"configs":{"itemId":"store","url":"m?xwl=sys/app/user/select-user"},"expanded":false,"children":[],"type":"store"}],"type":"combo","events":{"select":"app.PERSON_NAME.setValue(records[0].data.DISPLAY_NAME);"}}],"type":"panel"}],"type":"fieldset"},{"configs":{"layout":"fit","itemId":"basicInfo","title":"基本信息","collapsible":"true"},"expanded":true,"children":[{"configs":{"layout":"absolute","border":"false","itemId":"panel1","defaults":"{\n  labelAlign: 'right',\n  labelWidth: 80\n}","width":"576","height":"136"},"expanded":true,"children":[{"configs":{"itemId":"PERSON_CODE","allowBlank":"false","fieldLabel":"编号","x":"8","width":"216","y":"8","height":"22"},"expanded":false,"children":[],"type":"text"},{"configs":{"itemId":"PERSON_NAME","allowBlank":"false","fieldLabel":"姓名","x":"232","width":"216","y":"8","height":"22"},"expanded":false,"children":[],"type":"text"},{"configs":{"itemId":"SEX","fieldLabel":"性别","x":"8","width":"216","keyName":"sex","y":"40","height":"22"},"expanded":false,"children":[],"type":"combo"},{"configs":{"itemId":"BIRTHDATE","fieldLabel":"出生日期","x":"232","width":"216","y":"40","height":"22"},"expanded":false,"children":[],"type":"date"},{"configs":{"itemId":"NATION","fieldLabel":"民族","x":"8","width":"216","keyName":"nation","y":"72","height":"22"},"expanded":false,"children":[],"type":"combo"},{"configs":{"itemId":"MOBILE_PHONE","fieldLabel":"移动电话","x":"232","width":"216","y":"72","height":"22"},"expanded":false,"children":[],"type":"text"},{"configs":{"itemId":"ADDR","fieldLabel":"家庭地址","x":"8","width":"440","y":"104","height":"22"},"expanded":false,"children":[],"type":"text"},{"configs":{"itemId":"picImage","src":"wb/images/app/photo.jpg","x":"456","width":"103","y":"8","fileField":"PIC","height":"119"},"expanded":false,"children":[],"type":"image"}],"type":"panel"}],"type":"fieldset"},{"configs":{"layout":"fit","itemId":"eduInfo","title":"教育背景","collapsible":"true"},"expanded":true,"children":[{"configs":{"border":"false","itemId":"panel1","autoStyle":"true"},"expanded":true,"children":[{"configs":{"itemId":"EDU","fieldLabel":"学历","keyName":"edu"},"expanded":false,"children":[],"type":"combo"},{"configs":{"itemId":"SCHOOL","fieldLabel":"毕业院校"},"expanded":false,"children":[],"type":"text"},{"configs":{"itemId":"MAJOR","fieldLabel":"专业"},"expanded":false,"children":[],"type":"text"}],"type":"panel"}],"type":"fieldset"},{"configs":{"layout":"fit","itemId":"remarkInfo","title":"备注信息","collapsible":"true"},"expanded":true,"children":[{"configs":{"border":"false","layout":"fit","itemId":"panel1"},"expanded":true,"children":[{"configs":{"itemId":"REMARK","margin":"8","height":"80"},"expanded":false,"children":[],"type":"textarea"}],"type":"panel"}],"type":"fieldset"}],"type":"form"}],"type":"window","events":{"show":"if (app.editWin.editData.PIC) { //editData为Wb.edit方法创建的变量，值为编辑的记录数据\n  app.picImage.setSrc('m?xwl=admin/person/get-pic&id=' + app.editWin.editData.PERSON_ID + '&s=' + Wb.getId());\n} else {\n  app.picImage.setSrc('wb/images/app/photo.jpg');\n}","ok":"win.editHandler();"}},{"configs":{"layout":"border","itemId":"viewport1"},"expanded":true,"children":[{"configs":{"itemId":"mainToolbar","region":"north"},"expanded":true,"children":[{"configs":{"itemId":"newBtn","tooltip":"添加新的记录 (Ctrl+E)","text":"添加","iconCls":"record_add_icon"},"expanded":false,"children":[],"type":"item","events":{"click":"Wb.insert(app.grid1, {\n  win: app.editWin,\n  params: {\n    DEPT_ID: app.deptTree.DEPT_ID\n  },\n  url: 'm?xwl=admin/person/insert',\n  failure: app.failureHandler\n});"}},{"configs":{"itemId":"editBtn","tooltip":"修改选择的记录","text":"修改","iconCls":"record_edit_icon"},"expanded":false,"children":[],"type":"item","events":{"click":"Wb.edit(app.grid1, {\n  win: app.editWin,\n  url: 'm?xwl=admin/person/update',\n  failure: app.failureHandler\n});"}},{"configs":{"itemId":"delBtn","tooltip":"删除选择的记录","text":"删除","iconCls":"record_delete_icon"},"expanded":false,"children":[],"type":"item","events":{"click":"Wb.del(app.grid1, {\n  url: 'm?xwl=admin/person/delete',\n  titleField: 'PERSON_NAME'\n});"}},{"configs":{"itemId":"item1","text":"-"},"expanded":false,"children":[],"type":"item"},{"configs":{"itemId":"searchCombo","tpl":"<table cellspacing='0' width='100%'>\n  <tpl for='.'>\n    <tr class='x-boundlist-item'>\n      <td width='50px'>\n        {PERSON_CODE}\n      <\/td>\n      <td>\n        {PERSON_NAME}\n      <\/td>\n    <\/tr>\n  <\/tpl>\n<\/table>","onTriggerClick":"this.collapse();\napp.grid1.store.load({\n  out: app.mainToolbar\n});","emptyText":"编号或姓名","triggerCls":"x-form-search-trigger","width":"150","displayField":"PERSON_CODE","enterKeyTriggerClick":"true"},"expanded":true,"children":[{"configs":{"itemId":"store","url":"m?xwl=admin/person/search"},"expanded":false,"children":[],"type":"store","events":{"beforeload":"operation.params.allDept = app.deptTree.allDept;"}}],"type":"combo","events":{"select":"Ext.callback(combo.onTriggerClick, combo);"}},{"configs":{"itemId":"resetSearchBtn","tooltip":"重置搜索结果","text":"重置搜索","iconCls":"undo_icon"},"expanded":false,"children":[],"type":"item","events":{"click":"app.grid1.store.load();"}}],"type":"toolbar"},{"configs":{"layout":"fit","itemId":"container1","split":"true","width":"230","region":"west"},"expanded":true,"children":[{"configs":{"itemId":"deptTree","file":"m?xwl=sys/app/dept/dept-tree-control"},"expanded":false,"children":[],"type":"xwl"}],"type":"container"},{"configs":{"itemId":"grid1","region":"center","multiSelect":"true"},"expanded":true,"children":[{"configs":{"itemId":"store","normalName":"personStore","url":"m?xwl=admin/person/select"},"expanded":false,"children":[],"type":"store","events":{"beforeload":"operation.params.allDept = app.deptTree.allDept;"}},{"configs":{"itemId":"columns"},"expanded":true,"children":[{"configs":{"itemId":"rowNum","xtype":"rownumberer"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"picCol","renderer":"var url, style;\nif (record.data.PIC) {\n  url = 'm?xwl=admin/person/get-pic&id=' + record.data.PERSON_ID + '&s=' + Wb.getId();\n  style = ' style=\"cursor:pointer;\"';\n} else {\n  url = 'wb/images/null.png'; //使之保持相等行高\n  style = '';\n}\nreturn '<img' + style + ' width=\"32px\" height=\"32px\" src=\"' + url + '\">';","allowExport":"false","width":"50","text":"照片"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"personCodeCol","dataIndex":"PERSON_CODE","width":"70","text":"编号"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"personNameCol","dataIndex":"PERSON_NAME","text":"姓名"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"sexCol","dataIndex":"SEX","width":"50","keyName":"sex","text":"性别"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"birthDateCol","dataIndex":"BIRTHDATE","text":"出生日期"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"eduCol","dataIndex":"EDU","keyName":"edu","text":"学历"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"mobilePhoneCol","dataIndex":"MOBILE_PHONE","text":"移动电话"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"addrCol","dataIndex":"ADDR","flex":"1","text":"地址"},"expanded":false,"children":[],"type":"column"}],"type":"array"}],"type":"grid","events":{"afterrender":"grid.mon(grid.view.el, 'click', function(e, target) {\n  var src = target.src;\n  if (target.tagName == 'IMG' && !Ext.String.endsWith(src, '/null.png')) {\n    e.stopEvent();\n    Wb.run({\n      url: 'image-viewer',\n      single: true,\n      success: function() {\n        this.show(src);\n      }\n    });\n  }\n});","itemdblclick":"if (e.target.tagName != 'IMG')\n  app.editBtn.fireEvent('click');"}}],"type":"viewport","events":{"afterrender":"app.navKey = new Ext.KeyNav({\n  viewport: app.viewport1,\n  E: {\n    ctrl: true,\n    fn: function() {\n      app.newBtn.fireEvent('click');\n    }\n  }\n});"}}],"type":"module","events":{"initialize":"Wb.apply(app, {\n  /**\n   * 部门树selectChange时的回调函数。\n   */\n  onDeptTreeChange: function() {\n    app.personStore.load();\n  },\n  /**\n   * 插入或更新失败时执行的方法。\n   */\n  failureHandler: function(a, b, respText) {\n    if (respText.indexOf('WB_PERSON_USER_ID') != -1) {\n      Wb.error('该登录帐户已经被关联到别的人员。', function() {\n        app.USER_NAME.focus(true, true);\n      });\n    }\n  }\n});"}}],"roles":{"demo":1},"title":"人员管理","iconCls":"user_group_icon","inframe":false,"pageLink":""}